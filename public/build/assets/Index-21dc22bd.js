import{fl as g,gV as N,gW as y,gX as x,r as u,c as k,fp as t,fo as l,gT as w,gO as D,hi as V,gS as r,u as j,o as A,fu as h,fr as M,fs as H,gN as U,hh as I,gY as v}from"./vee-validate-i18n.esm-b9e812f9.js";import{y as P}from"./vue-multiselect.esm-6b6e0179.js";import{u as F}from"./tenant-store-d558fdeb.js";import{_ as q}from"./Spinner-c7efc148.js";import{_ as E}from"./ModalForm-612e21ff.js";import"./CropperImage-c2cb432e.js";const K={class:"section-body"},O=t("h2",{class:"section-title fs-lg"},"Daftar Barang",-1),Y=t("p",{class:"section-lead"}," Daftar barang yang akan ditampilkan pada halaman utama ",-1),L={class:"row"},Q={class:"col-12"},R={class:"card border-gray-light"},W={class:"card-body"},X={class:"action-wrapper d-flex mb-3 flex-wrap align-items-center justify-content-between"},z={class:"left-section"},G={class:"right-section mt-2 mt-md-0"},J={class:"input-group"},Z={class:"input-group-prepend"},ee={class:"input-group-text"},te={class:"text-center"},ae=t("span",null,"Belum ada data",-1),ne={class:"text-center"},se=t("span",null,"Data tidak ditemukan",-1),le={class:"d-flex align-items-baseline justify-content-center"},oe={class:"text-right"},ie={class:"d-flex flex-column"},re={class:"footer-wrapper"},ce={class:"d-flex justify-content-between align-items-center"},he={__name:"Index",setup(de){const _=g(null),S=P(),B=F(),f=g(!1),a=g({busy:!1,fields:[{key:"action",label:"Aksi",class:"text-center",sortable:!1,thStyle:{width:"35px"}},{key:"rownum",label:"No",thStyle:{width:"35px",textAlign:"center"}},{key:"tenant_name",label:"Nama Tenan",thStyle:{textAlign:"center",width:"20%"}},{key:"product_name",label:"Nama Barang",thStyle:{textAlign:"center",width:"20%"}},{key:"description",label:"Deskripsi",thStyle:{textAlign:"center"}},{key:"minimum_qty",label:"Minimum QTY",thStyle:{textAlign:"center",width:"88px"}},{key:"minimum_unit",label:"Minimum Unit",thStyle:{textAlign:"center",width:"88px"}},{key:"tkdn_value",label:"Nilai TKDN",thStyle:{textAlign:"center",width:"88px"}},{key:"price",label:"Harga",thStyle:{textAlign:"center",width:"88px"}},{key:"condition",label:"Kondisi",thStyle:{textAlign:"center",width:"88px"}}],search:{filter:null,columns:["name","description"]},meta:{page:1,from:1,limit:15,total:0}}),T=N.debounce((o,e)=>{a.value.busy=!0,y.get(x("backend.product.get",{search:a.value.search.filter,columns:a.value.search.columns.join(","),page:o.currentPage,limit:o.perPage})).then(s=>{var i,c,d,p,m;a.value.meta.from=(i=s.data)==null?void 0:i.meta.from,a.value.meta.page=(c=s.data)==null?void 0:c.meta.current_page,a.value.meta.limit=(d=s.data)==null?void 0:d.meta.per_page,a.value.meta.total=(p=s.data)==null?void 0:p.meta.total,e((m=s.data)==null?void 0:m.data)}).catch(()=>e([])).finally(()=>setTimeout(()=>a.value.busy=!1,500))},500),$=o=>{I({title:"Hapus Barang",text:`Apakah Anda yakin untuk menghapus data barang an. ${o.product_name}?`,icon:"question"},()=>y.post(x("backend.product.drop"),{_method:"delete",slug:o.slug}).then(e=>e).catch(e=>{let s=e.response.status,i=e.response.data.message;if([409,417,500].includes(s)){v.showValidationMessage(`${i}`);return}if(s=="422"){const c=e.response.data.errors;i=Object.keys(c).map(d=>Array.isArray(c[d])?c[d].join(", "):c[d]).join(", "),v.showValidationMessage(`${i}`);return}})).then(({value:e,isConfirmed:s,isDismissed:i})=>{if(i)return!1;s&&e&&v.fire({title:"Hapus Barang Berhasil",text:`Barang an ${o.product_name} berhasil dihapus`,icon:"success"}),_.value.refresh()})},C=o=>{B.setItemByUrl(o.slug,o),S.push({name:"settings.product.detail",params:{slug:o.slug}})};return(o,e)=>{const s=u("FontAwesomeIcon"),i=u("b-button"),c=u("b-table"),d=u("b-dropdown-item"),p=u("b-dropdown"),m=u("b-pagination");return A(),k("div",K,[O,Y,t("div",L,[t("div",Q,[t("div",R,[t("div",W,[t("div",X,[t("div",z,[t("button",{class:"btn btn-icon icon-left btn-primary",onClick:e[0]||(e[0]=n=>f.value=!0)},[l(s,{icon:["fas","plus"]}),w(" Tambah ")])]),t("div",G,[t("div",J,[t("div",Z,[t("div",ee,[l(s,{icon:["fas","search"]})])]),D(t("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>a.value.search.filter=n),type:"text",class:"form-control",placeholder:"Pencarian"},null,512),[[V,a.value.search.filter]])])])]),l(c,{ref_key:"refTable",ref:_,"table-class":"custom-bordered dataTable",fields:a.value.fields,items:j(T),filter:a.value.search.filter,"current-page":a.value.meta.page,"per-page":a.value.meta.limit,busy:a.value.busy,"show-empty":"",hover:"",striped:"",responsive:""},{"table-busy":r(()=>[l(q)]),empty:r(()=>[t("div",te,[l(s,{icon:["fas","exclamation-circle"],class:"mr-2"}),ae])]),emptyfiltered:r(()=>[t("div",ne,[l(s,{icon:["fas","exclamation-circle"],class:"mr-2"}),se])]),"cell(action)":r(({item:n})=>[t("div",le,[l(i,{variant:"link",class:"text-info py-0 px-1 outline-none cursor-pointer",onClick:b=>C(n)},{default:r(()=>[l(s,{icon:["fas","info-circle"]})]),_:2},1032,["onClick"]),l(i,{variant:"link",class:"text-danger py-0 px-1 outline-none cursor-pointer",onClick:b=>$(n)},{default:r(()=>[l(s,{icon:["fas","trash-alt"]})]),_:2},1032,["onClick"])])]),"cell(rownum)":r(({index:n})=>[t("div",oe,h(n+1),1)]),"cell(condition)":r(({item:n})=>[t("div",ie,h(n.condition==0?"Baru":"Bekas"),1)]),_:1},8,["fields","items","filter","current-page","per-page","busy"]),t("div",re,[t("div",ce,[l(p,{variant:"light",class:"mr-2 form-control-height-sm perpage",text:a.value.meta.limit.toString()},{default:r(()=>[(A(),k(M,null,H([5,10,15,25,50,100],n=>l(d,{key:n,"link-class":"btn",onClick:U(b=>a.value.meta.limit=n,["prevent"])},{default:r(()=>[w(h(n),1)]),_:2},1032,["onClick"])),64))]),_:1},8,["text"]),l(m,{value:a.value.meta.page,"onUpdate:value":e[2]||(e[2]=n=>a.value.meta.page=n),"total-rows":a.value.meta.total,"per-page":a.value.meta.limit,"aria-controls":"group-table","first-class":"hidden-md-down","last-class":"hidden-md-down",class:"pagination mb-0",onChange:e[3]||(e[3]=n=>a.value.meta.page=n)},null,8,["value","total-rows","per-page"])])])])])])]),l(E,{visible:f.value,"onUpdate:visible":e[4]||(e[4]=n=>f.value=n),onSubmit:e[5]||(e[5]=n=>_.value.refresh())},null,8,["visible"])])}}};export{he as default};
