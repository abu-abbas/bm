import{fl as V,fq as H,r as B,o as r,c as d,fo as i,fp as e,fu as q,fv as T,u as p,fI as N,a as E,gS as g,gZ as A,g_ as S,gT as D,g$ as P,hh as z,gY as R,gW as J,gX as W}from"./vee-validate-i18n.esm-b9e812f9.js";import{_ as X}from"./CropperImage-c2cb432e.js";const Y=["accept"],Z={key:1,class:"preview-wrapper"},G=["src"],K={key:2,class:"fs-nano text-danger"},Q={__name:"UploadingImageTenant",props:{accept:{type:Array,required:!1,default:()=>["image/gif","image/jpg","image/jpeg","image/png","image/tiff","image/webp"]},maxSize:{type:Number,required:!1,default:5},modelValue:{type:[File,null],required:!0,default:null},urlObject:{type:[String,null],required:!1,default:null},errorMessage:{type:[String,null],required:!1,default:null}},emits:["update:modelValue","update:urlObject","cropping"],setup(U,{emit:f}){const c=U,x=Math.random().toString(36).substring(2,9),h=`uploader-image-${x}`,o=window.URL||window.webkitURL,t=V({visible:!1,input:null,output:null,name:null,mime:null,file:null}),_=H(()=>c.accept.join(",")),b=u=>{if(!u.target.files.length)return;const l=u.target.files[0];t.value.input=o.createObjectURL(l),t.value.visible=!0,t.value.name=l.name,t.value.mime=l.type,N(()=>u.target.value="")},O=({image:u})=>{t.value.output=o.createObjectURL(u),t.value.file=new File([u],t.value.name,{type:t.value.mime}),$()},j=()=>{t.value.input=null,t.value.output=null,t.value.file=null,$()},$=()=>{f("update:modelValue",t.value.file),f("update:urlObject",t.value.output),f("cropping",{file:t.value.file,urlObject:t.value.output})};return(u,l)=>{const m=B("FontAwesomeIcon");return r(),d("div",{key:p(x),class:"uploader-image-wrapper"},[t.value.output?(r(),d("div",Z,[e("img",{src:t.value.output,class:"image-preview",alt:"Output after crop and resize"},null,8,G),e("a",{href:"javascript:void(0)",onClick:j},[i(m,{icon:["fas","trash-alt"]})])])):(r(),d("label",{key:0,for:h,class:"border"},[i(m,{icon:["far","image"]}),e("input",{id:h,type:"file",name:"upload",accept:_.value,onChange:b},null,40,Y)])),i(X,{visible:t.value.visible,"onUpdate:visible":l[0]||(l[0]=n=>t.value.visible=n),"image-url":t.value.input,onAfterCropping:O},null,8,["visible","image-url"]),c.errorMessage?(r(),d("div",K,q(c.errorMessage),1)):T("",!0)])}}};const ee={class:"px-3 pb-0 mb-0"},te={class:"form-group row"},ae=e("label",{for:"nama",class:"col-sm-3 col-form-label"}," Nama ",-1),se={class:"col-sm-9"},oe={key:0,class:"form-text text-danger fs-nano"},le={class:"form-group row"},ne=e("label",{for:"lokasi",class:"col-sm-3 col-form-label"}," Lokasi Singkat ",-1),ie={class:"col-sm-9"},re=e("span",{class:"form-text text-muted fs-nano"},"Contoh: Jakarta Pusat",-1),ue={key:0,class:"form-text text-danger fs-nano"},ce={class:"form-group row"},de=e("label",{for:"deskripsi",class:"col-sm-3 col-form-label"}," Deskripsi ",-1),me={class:"col-sm-9"},pe={key:0,class:"form-text text-danger fs-nano"},fe={class:"form-group row"},_e=e("label",{class:"col-sm-3 col-form-label"}," Logo ",-1),ve={class:"col-sm-9"},ge={key:0,class:"preview-wrapper"},he=["src","alt"],be={class:"form-group row"},ke={class:"col-sm-9 offset-sm-3"},ye={type:"submit",class:"btn btn-primary mr-2"},we=["onClick"],$e={__name:"ModalForm",props:{visible:{type:Boolean,required:!0,default:!1},initData:{type:[Object,null],required:!1,default:()=>{}},isEdit:{type:Boolean,required:!0,default:!1}},emits:["update:visible","submit"],setup(U,{emit:f}){const c=U,x=Math.random().toString(36).substring(2,9),h=H(()=>c.visible),o=H(()=>c.initData),t=V(null),_=V(null),b=V(!1),O=()=>N(()=>{t.value.focus(),o.value&&(_.value.setFieldValue("name",o.value.name),_.value.setFieldValue("short_location",o.value.short_location),_.value.setFieldValue("description",o.value.description),b.value=!0)}),j=()=>f("update:visible",!1),$=()=>b.value=!1,u=(l,{resetForm:m})=>{var w;const n=c.isEdit,L=n?`Apakah Anda yakan untuk mengubah data ${(w=o.value)==null?void 0:w.name} ?`:`Apakah Anda yakin untuk menambahkan ${l.name} sebagai tenant?`,k=n?"put":"post",C=`backend.tenant.${n?"edit":"store"}`;let y=!1;n&&Object.keys(l).forEach(s=>{l[s]!=o.value[s]&&(y=!0)}),!(n&&!y)&&z({title:`${n?"Ubah":"Tambah"} tenant`,text:L,icon:"question"},()=>{var s;return J.post(W(C),{...l,_method:k,slug:n?(s=o.value)==null?void 0:s.slug:null},{headers:{"Content-Type":"multipart/form-data"}}).then(a=>a).catch(a=>{let F=a.response.status,v=a.response.data.message;if([409,417,500].includes(F)){R.showValidationMessage(`${v}`);return}if(F=="422"){const I=a.response.data.errors;v=Object.keys(I).map(M=>Array.isArray(I[M])?I[M].join(", "):I[M]).join(", "),R.showValidationMessage(`${v}`);return}})}).then(({value:s,isConfirmed:a,isDismissed:F})=>{var v;if(F)return!1;a&&s.data.status=="success"&&(R.fire({title:"Tambah tenant",text:s.data.message,icon:"success"}),m(),f("submit",(v=s.data)==null?void 0:v.data),j())})};return(l,m)=>{const n=B("FontAwesomeIcon"),L=B("b-modal");return r(),E(L,{id:p(x),visible:h.value,"onUpdate:visible":m[0]||(m[0]=k=>h.value=k),title:`${c.isEdit?"Ubah":"Tambah"} Tenant`,"hide-footer":"",onShown:O,onHide:j},{default:g(({hide:k})=>[e("div",ee,[i(p(P),{ref_key:"formRef",ref:_,onSubmit:u},{default:g(()=>{var C,y,w;return[e("div",te,[ae,e("div",se,[i(p(A),{label:"Nama tenant",name:"name",rules:"required|min:3|max:200"},{default:g(({field:s,errorMessage:a})=>[e("input",S({id:"nama",ref_key:"nameInput",ref:t},s,{type:"text",class:"form-control",placeholder:"Masukkan nama tenant"}),null,16),a?(r(),d("div",oe,q(a),1)):T("",!0)]),_:1})])]),e("div",le,[ne,e("div",ie,[i(p(A),{label:"Lokasi singkat",name:"short_location",rules:"max:50"},{default:g(({field:s,errorMessage:a})=>[e("input",S({id:"lokasi"},s,{type:"text",class:"form-control",placeholder:"Masukkan lokasi singkat tenant"}),null,16),re,a?(r(),d("div",ue,q(a),1)):T("",!0)]),_:1})])]),e("div",ce,[de,e("div",me,[i(p(A),{label:"Deskripsi",name:"description",rules:"max:2000"},{default:g(({field:s,errorMessage:a})=>[e("textarea",S({id:"deskripsi"},s,{type:"text",class:"form-control custom-scroll",placeholder:"Masukkan deskripsi tentang tenant"}),null,16),a?(r(),d("div",pe,q(a),1)):T("",!0)]),_:1})])]),e("div",fe,[_e,e("div",ve,[b.value?(r(),d("div",ge,[e("img",{src:(y=(C=o.value)==null?void 0:C.logo)==null?void 0:y.thumb,alt:(w=o.value)==null?void 0:w.name,class:"image-preview"},null,8,he),e("a",{href:"javascript:void(0)",onClick:$},[i(n,{icon:["fas","trash-alt"]})])])):(r(),E(p(A),{key:1,label:"Logo",name:"logo",rules:"required"},{default:g(({field:s,errorMessage:a})=>[i(Q,S(s,{"error-message":a}),null,16,["error-message"])]),_:1}))])]),e("div",be,[e("div",ke,[e("button",ye,[i(n,{icon:["fas","save"],class:"mr-1"}),D(" Simpan ")]),e("button",{type:"reset",class:"btn btn-light",onClick:k}," Batal ",8,we)])])]}),_:2},1536)])]),_:1},8,["id","visible","title"])}}};export{$e as _};
