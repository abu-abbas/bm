import{r as c,c as g,hA as b,o as A,j as V,k as T,fT as w,b as d,f as n,e as v,fB as z,fC as f,_ as F}from"./vee-validate-i18n.esm-8795b5a9.js";import{C as $}from"./vue-multiselect.esm-5ac34b22.js";import{_ as M}from"./Index-11cf138d.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./jquery-04f6ad4f.js";const Q={class:"kalles-section page_section_heading"},R={class:"page-head tc pr oh cat_bg_img page_head_"},W=["data-bgset"],j=n("div",{class:"container pr z_100"},[n("h1",{class:"mb__5 cw"},"Pindai Qrcode")],-1),G={class:"kalles-section nt_section type_featured_collection tp_se_cdt"},L={class:"kalles-digital__bestselling-section container"},U={class:"text-center px-5"},X={class:"fs-sm"},Y={class:"py-5"},J={key:0,class:"loading-indicator text-center"},K={key:1,class:"validation-success"},Z={key:2,class:"validation-failure"},ee={key:3,class:"validation-pending"},te={key:1,class:"error text-center"},ue={__name:"Index",setup(ae){const m=c(""),l=c(""),x=c(!0),p=c(!1),_=c(null),S=$(),s=c({list:[],selected:null}),y=c({options:{aztec:!1,code_128:!1,code_39:!1,code_93:!1,codabar:!1,databar:!1,databar_expanded:!1,data_matrix:!1,dx_film_edge:!1,ean_13:!1,ean_8:!1,itf:!1,maxi_code:!1,micro_qr_code:!1,pdf417:!1,qr_code:!0,rm_qr_code:!1,upc_a:!1,upc_e:!1,linear_codes:!1,matrix_codes:!1}}),C=g(()=>Object.keys(y.value.options).filter(t=>y.value.options[t])),k=c({options:[{text:"nothing (default)",value:void 0},{text:"outline",value:(t,e)=>{for(const o of t){const[a,...r]=o.cornerPoints;e.strokeStyle="red",e.beginPath(),e.moveTo(a.x,a.y);for(const{x:i,y:u}of r)e.lineTo(i,u);e.lineTo(a.x,a.y),e.closePath(),e.stroke()}}},{text:"centered text",value:(t,e)=>{for(const o of t){const{boundingBox:a,rawValue:r}=o,i=a.x+a.width/2,u=a.y+a.height/2,h=Math.max(12,50*a.width/e.canvas.width);e.font=`bold ${h}px sans-serif`,e.textAlign="center",e.lineWidth=3,e.strokeStyle="#35495e",e.strokeText(o.rawValue,i,u),e.fillStyle="#5cb984",e.fillText(r,i,u)}}},{text:"bounding box",value:(t,e)=>{for(const o of t){const{boundingBox:{x:a,y:r,width:i,height:u}}=o;e.lineWidth=2,e.strokeStyle="#007bff",e.strokeRect(a,r,i,u)}}}],selected:null}),B=t=>{l.value=`[${t.name}]: `,t.name==="NotAllowedError"?l.value+="you need to grant camera access permission":t.name==="NotFoundError"?l.value+="no camera on this device":t.name==="NotSupportedError"?l.value+="secure context required (HTTPS, localhost)":t.name==="NotReadableError"?l.value+="is the camera already in use?":t.name==="OverconstrainedError"?l.value+="installed cameras are not suitable":t.name==="StreamApiNotSupportedError"?l.value+="Stream API is not supported in this browser":t.name==="InsecureContextError"?l.value+="Camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP.":l.value+=t.message},P=g(()=>(_.value===void 0||_.value===null)&&p.value),E=g(()=>_.value===!0),N=g(()=>_.value===!1),q=async([t])=>{var e;if(m.value=t.rawValue,p.value=!0,m.value&&(_.value=(e=m.value)==null?void 0:e.startsWith(F.home),_.value)){const o=`${m.value}`.split("/t/").pop();O.fire({icon:"success",title:"Anda akan diarahkan kehalaman Tenant"}).then(a=>{a.isDismissed&&a.dismiss=="timer"&&S.push({name:"tenant.home",params:{slug:o}})})}await D(3e3),p.value=!1},D=t=>new Promise(e=>window.setTimeout(e,t)),H=()=>x.value=!1,I=t=>{const e=s.value.list.findIndex(o=>o.label==t);s.value.selected=s.value.list[e==0?1:0]},O=b.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:t=>{t.onmouseenter=b.stopTimer,t.onmouseleave=b.resumeTimer}});return A(async()=>{var t;k.value.selected=k.value.options[1],s.value.list=(await((t=navigator==null?void 0:navigator.mediaDevices)==null?void 0:t.enumerateDevices())||[]).filter(({kind:e})=>e=="videoinput"),s.value.list.length>0&&(s.value.selected=s.value.list[0])}),(t,e)=>{const o=V("qrcode-stream");return d(),T(M,null,{default:w(()=>{var a,r,i;return[n("div",Q,[n("div",R,[n("div",{class:"parallax-inner nt_parallax_false lazyload nt_bg_lz pa t__0 l__0 r__0 b__0","data-bgset":t.MainSlide},null,8,W),j])]),n("div",G,[n("div",L,[n("div",U,[s.value.list.length>1?(d(),v("button",{key:0,class:"btn btn-dark btn-block round_true",onClick:e[0]||(e[0]=u=>{var h;return I((h=s.value.selected)==null?void 0:h.label)})},[n("span",X,z((r=(a=s.value.selected)==null?void 0:a.label)!=null&&r.includes("front")?"Gunakan kamera belakang":"Gunakan kamera depan"),1)])):f("",!0)]),n("div",Y,[s.value.selected!==null?(d(),T(o,{key:0,constraints:{deviceId:(i=s.value.selected)==null?void 0:i.deviceId},track:k.value.selected,formats:C.value,pause:p.value,onCameraOn:H,onError:B,onDetect:q},{default:w(()=>[x.value?(d(),v("div",J," Loading... ")):f("",!0),E.value?(d(),v("div",K," Qrcode valid ")):f("",!0),N.value?(d(),v("div",Z," Qrcode tidak valid ")):f("",!0),P.value?(d(),v("div",ee," proses validasi qrcode... ")):f("",!0)]),_:1},8,["constraints","track","formats","pause"])):(d(),v("p",te," No cameras on this device "))])])])]}),_:1})}}};export{ue as default};
