import{r as k,o as W,_ as R,hn as M,ho as E,hp as Y,c as rt,w as ut,b as m,e as h,f as t,h as U,u as a,fB as d,fA as q,hm as at,fp as ct,j as X,fy as G,fV as H,fx as I,fT as B,hr as _t,hq as D,fR as pt,fC as K,g as mt,ge as gt,hB as J,hC as vt,fX as ot,k as nt,fz as ft}from"./vee-validate-i18n.esm-8795b5a9.js";import{f as N}from"./formatter-8fa69f9f.js";import{X as ht,C as dt}from"./vue-multiselect.esm-5ac34b22.js";import{u as bt}from"./product-store-d4bdc2eb.js";import{u as kt}from"./useFlickity-bd887c19.js";import{_ as yt}from"./Index-11cf138d.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./jquery-04f6ad4f.js";const Q=bt(),{getSelectedByTenantAndUrl:$t}=ht(Q),xt=(A,i)=>{const w=dt(),u=k({data:null,found:!1,loading:!1}),l=()=>{u.value.loading=!0;const b=R.products.find(n=>n.slug==i&&n.tenant_slug==A);if(b){u.value.loading=!1,u.value.found=!0,u.value.data=b,Q.setItem(b),console.log("form setting");return}if($t.value(A,i)){u.value.loading=!1,u.value.found=!0,u.value.data=b,console.log("form store");return}M.get(E("backend.landing.product.getsingelproduct",{tenant:A,product:i})).then(n=>{var y;if(!((y=n==null?void 0:n.data)!=null&&y.data))throw new"Data tidak ditemukan";u.value.found=!0,u.value.data=n.data.data,Q.setItem(n.data.data),console.log("form db")}).catch(n=>{u.value.found=!1,u.value.data=null,Y.fire({title:"Gagal mendapatkan data produk",text:(n==null?void 0:n.message)||"Error tidak diketahui",icon:"error"})}).finally(()=>u.value.loading=!1)},g=()=>{w.push({name:"tenant.home",params:{slug:A}})};return W(()=>l()),{product:u,backToTenant:g}};const wt=["id"],St={class:"header"},At=t("span",null,null,-1),Vt=[At],Ct={class:"static-title d-flex flex-column"},Bt=t("h2",null,"Fixed Header",-1),It={class:"body"},Tt={__name:"BottomSheet",props:{visible:{type:Boolean,required:!0,default:!1}},emits:["update:visible","show","hide"],setup(A,{emit:i}){const w=A,u=Math.random().toString(36).substring(2,9),l=k(null),g=k(null),b=k(null),v=k(null),n=k(!1),y=k(null),f=k(null),c=rt(()=>w.visible),V=s=>{b.value.style.height=`${s}vh`,l.value.classList.toggle("fullscreen",s===100)},T=()=>{l.value.classList.remove("show"),document.body.style.overflowY="auto",i("update:visible",!1),i("hide")},F=()=>{l.value.classList.add("show"),document.body.style.overflowY="hidden",V(50),i("update:visible",!0),i("show")},P=s=>{var _;n.value=!0,y.value=s.pageY||((_=s.touches)==null?void 0:_[0].pageY),f.value=parseInt(b.value.style.height),l.value.classList.add("dragging")},o=s=>{var $;if(!n.value)return;const _=y.value-(s.pageY||(($=s.touches)==null?void 0:$[0].pageY)),S=f.value+_/window.innerHeight*100;V(S)},e=()=>{n.value=!1,l.value.classList.remove("dragging");const s=parseInt(b.value.style.height);s<25?T():s>75?V(100):V(50)};return ut(()=>c.value,s=>s?F():T()),(s,_)=>(m(),h("div",{id:a(u),ref_key:"bottomSheet",ref:l,class:"bottom-sheet"},[t("div",{ref_key:"sheetOverlay",ref:g,class:"sheet-overlay",onClick:T},null,512),t("div",{ref_key:"sheetContent",ref:b,class:"content"},[t("div",St,[t("div",{ref_key:"dragIcon",ref:v,class:"drag-icon",onMousedown:P,onMousemove:o,onMouseup:e,onTouchstart:P,onTouchmove:o,onTouchend:e},Vt,544),t("div",Ct,[U(s.$slots,"fixed-header",{},()=>[Bt]),U(s.$slots,"fixed-content")])]),t("div",It,[U(s.$slots,"header"),U(s.$slots,"default")])],512)],8,wt))}},qt={class:"d-flex flex-column"},Lt={class:q({"program mb-2":!0,"d-none":!0})},Ft=t("strong",{class:"text-sm text-muted"},"Program:",-1),Pt=t("strong",{class:"text-sm text-muted"},"Kegiatan:",-1),Kt=t("strong",{class:"text-sm text-muted"},"Subkegiatan:",-1),Nt={class:q({"rsk mb-1":!0})},jt=t("strong",{class:"text-sm text-muted"},"PASK:",-1),Ht={class:q({"akun mb-1":!0})},Rt=t("strong",{class:"text-sm text-muted"},"Akun:",-1),zt={class:"fw-bolder"},Ot={class:q({"anggaran mb-1":!0})},Ut=t("strong",{class:"text-sm text-muted"},"Nilai Anggaran:",-1),Yt={class:"text-info fw-bolder"},Dt={class:"used"},Mt=t("strong",{class:"text-sm text-muted"},"Penggunaan untuk ketertarikan:",-1),Et={class:"text-danger fw-bolder"},lt={__name:"Format",props:{item:{type:Object,required:!0},onlyAccount:{type:Boolean,required:!1,default:!1}},setup(A){const i=A;return(w,u)=>{var l,g,b,v,n,y,f,c,V;return m(),h("div",qt,[t("div",Lt,[Ft,t("div",null,d((l=i.item)==null?void 0:l.nama_program),1)]),t("div",{class:q({"kegiatan mb-1":!0,"d-none":i.onlyAccount})},[Pt,t("div",null,d((g=i.item)==null?void 0:g.nama_kegiatan),1)],2),t("div",{class:q({"subkegiatan mb-1":!0,"d-none":i.onlyAccount})},[Kt,t("div",null,d((b=i.item)==null?void 0:b.nama_subkegiatan),1)],2),t("div",Nt,[jt,t("div",null,d((v=i.item)==null?void 0:v.no_rsk)+" - "+d((n=i.item)==null?void 0:n.nama_rsk),1)]),t("div",Ht,[Rt,t("div",zt,d((y=i.item)==null?void 0:y.kode_akun),1),t("div",null,d((f=i.item)==null?void 0:f.nama_akun),1)]),t("div",Ot,[Ut,t("div",Yt,d(a(N)((c=i.item)==null?void 0:c.dpa_rsk)),1)]),t("div",Dt,[Mt,t("div",Et,d(a(N)((V=i.item)==null?void 0:V.has_transaction)),1)])])}}};const Xt={class:"checkout-wrapper"},Gt=t("h2",null,"Ajukan ketertarikan",-1),Jt={class:"media mb-2"},Qt=["src","alt"],Wt={class:"media-body"},Zt={class:"fs-sm product-name"},te={class:"fs-sm"},ee={class:"fs-nano product-desc"},se={class:"fs-sm mt-2"},ae={class:"form-group"},oe=t("label",{class:"form-label text-muted"},"Anggaran",-1),ne={key:0,class:"text-danger fs-sm mt-2"},le={key:0,class:"form-group"},ie=t("label",{class:"form-label text-muted"},"Kuantitas",-1),re={class:"input-group"},de=t("span",{class:"input-group-text"},"-",-1),ue=[de],ce=t("span",{class:"input-group-text"},"+",-1),_e=[ce],pe={key:0,class:"text-danger fs-sm mt-2"},me={key:1,class:"form-group"},ge=t("label",{class:"form-label text-muted"},"Nilai Penawaran",-1),ve={class:"form-control custom-form-control text-right font-bold input-readonly text-muted"},fe={key:2,class:"form-group"},he=t("label",{class:"form-label text-muted"},"Nilai Ketertarikan",-1),be={key:0,class:"text-danger fs-sm mt-2"},ke={key:0,class:"fs-sm text-muted mt-1 text-right"},ye=t("div",{class:"space-helper"},null,-1),$e={__name:"Index",props:{tenantSlug:{type:[String,null],required:!0,default:null},productSlug:{type:[String,null],required:!0,default:null},product:{type:[Object,null],required:!0,default:()=>{}},class:{type:[String,Object,Array],required:!1,default:"btn btn-lg btn-primary"}},emits:["update:product"],setup(A,{emit:i}){const w=A,u=dt(),l=rt(()=>{var o;return{tenantSlug:w.tenantSlug,productSlug:w.productSlug,product:w.product,selisih:((o=c.value.selected)==null?void 0:o.balance)-n.value||0}}),g=k(1),b=k(null),v=k(null),n=k(0),y=k(!1),f=k(!1),c=k({options:[],selected:null,loading:!1,props:{trackBy:"slug",label:"nama_akun",placeholder:"Pilih Anggaran",selectLabel:"",selectedLabel:"",deselectLabel:""}}),V=()=>{var o,e;if(!R.user){J();return}if((e=(o=l.value)==null?void 0:o.product)!=null&&e.has_transaction){u.push({name:"landing.transaction"});return}f.value=!0},T=at.debounce(function(o=null,e=!1){!o&&!e||(c.value.loading=!0,M.get(E("backend.budget.all",{search:o==null?void 0:o.toLowerCase()})).then(s=>c.value.options=s.data.data).catch(()=>c.value.options=[]).finally(()=>c.value.loading=!1))},500),F=at.debounce(o=>{const e="0123456789.",_=[...`${o.target.value}`.split(",").shift()].filter($=>e.includes($)).join("");o.target.value=_;const S=parseFloat(o.target.value.split(".").join("")||0);n.value=S,o.target.value=N(S)},1e3);ct("voi_value",(o,[e])=>o==0?"Nilai ketertarikan tidak boleh 0":(console.log({target:e}),!0));const P=async()=>{const{valid:o}=await v.value.validate();o&&vt({title:"Buat ketertarikan",text:"Apakah Anda yakin untuk membuat ketertarikan ini?",icon:"question"},()=>{var e,s;return M.post(E("backend.transaction.store"),{product:w.productSlug,eventId:((s=(e=R)==null?void 0:e.events[0])==null?void 0:s.flag)=="active"?R.events[0].id:null,...v.value.getValues()}).then(_=>_).catch(_=>{let S=_.response.status,$=_.response.data.message;if([409,417,500].includes(S)){Y.showValidationMessage(`${$}`);return}if(S=="422"){const x=_.response.data.errors;$=Object.keys(x).map(C=>Array.isArray(x[C])?x[C].join(", "):x[C]).join(", "),Y.showValidationMessage(`${$}`);return}})}).then(({value:e,isConfirmed:s,isDismissed:_})=>{if(_)return!1;s&&e.data.status=="success"&&(Y.fire({title:"Tambah ketertarikan",text:e.data.message,icon:"success"}),i("update:product",{...l.value.product,has_transaction:!0}),y.value=!0,f.value=!1,u.push({name:"landing.transaction"}))})};return W(()=>{var o,e;T(null,!0),y.value=(e=(o=l.value)==null?void 0:o.product)==null?void 0:e.has_transaction}),(o,e)=>{var S,$;const s=X("FontAwesomeIcon"),_=X("vue-multiselect");return m(),h("div",Xt,[t("button",{class:q([w.class]),onClick:V},[($=(S=l.value)==null?void 0:S.product)!=null&&$.has_transaction||y.value?(m(),h(G,{key:0},[H(" Lihat ketertarikan ")],64)):(m(),h(G,{key:1},[I(s,{icon:["fas","plus"]}),H(" Ketertarikan ")],64))],2),I(Tt,{visible:f.value,"onUpdate:visible":e[8]||(e[8]=x=>f.value=x)},{"fixed-header":B(()=>[Gt]),"fixed-content":B(()=>{var x,C,L,p,r,j,z,O,Z,tt,et,st;return[t("div",Jt,[t("img",{class:"image-wrapper mr-3",src:(C=(x=l.value)==null?void 0:x.product)==null?void 0:C.images[0],alt:(p=(L=l.value)==null?void 0:L.product)==null?void 0:p.name},null,8,Qt),t("div",Wt,[t("strong",Zt,d((j=(r=l.value)==null?void 0:r.product)==null?void 0:j.product_name),1),t("strong",te,d(a(N)(((O=(z=l.value)==null?void 0:z.product)==null?void 0:O.price)||0)),1),t("div",ee,d((tt=(Z=l.value)==null?void 0:Z.product)==null?void 0:tt.description),1),t("strong",se,d((st=(et=l.value)==null?void 0:et.product)==null?void 0:st.tenant_name),1)])])]}),default:B(()=>[I(a(_t),{ref_key:"formRef",ref:v},{default:B(({errors:x})=>{var C,L;return[t("div",ae,[oe,I(a(D),{modelValue:c.value.selected,"onUpdate:modelValue":e[1]||(e[1]=p=>c.value.selected=p),label:"Anggaran",name:"anggaran",rules:"required"},{default:B(({errorMessage:p})=>[I(_,pt({modelValue:c.value.selected,"onUpdate:modelValue":e[0]||(e[0]=r=>c.value.selected=r)},c.value.props,{"track-by":"slug","select-label":"","selected-label":"","deselect-label":"",label:"nama_akun","open-direction":"bottom",class:"dropdown-custom",placeholder:"Pilih Anggaran","internal-search":!1,"clear-on-select":!1,"hide-selected":!1,"max-height":500,"option-height":250,options:c.value.options,loading:c.value.loading,onSearchChange:a(T)}),{noResult:B(()=>[H("Data tidak ditemukan")]),noOptions:B(()=>[H("Tidak ada data")]),option:B(r=>[I(lt,{item:r.option},null,8,["item"])]),singleLabel:B(r=>[I(lt,{item:r.option,"only-account":""},null,8,["item"])]),_:1},16,["modelValue","options","loading","onSearchChange"]),p?(m(),h("div",ne,d(p),1)):K("",!0)]),_:1},8,["modelValue"])]),c.value.selected?(m(),h("div",le,[ie,I(a(D),{modelValue:g.value,"onUpdate:modelValue":e[5]||(e[5]=p=>g.value=p),label:"Kuantitas",name:"qty",rules:"required|min_value:1"},{default:B(({errorMessage:p})=>[t("div",re,[t("div",{class:"input-group-prepend",onClick:e[2]||(e[2]=r=>g.value--)},ue),mt(t("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>g.value=r),type:"text",class:"form-control text-right custom-form-control font-bold"},null,512),[[gt,g.value]]),t("div",{class:"input-group-append",onClick:e[4]||(e[4]=r=>g.value++)},_e)]),p?(m(),h("div",pe,d(p),1)):K("",!0)]),_:1},8,["modelValue"])])):K("",!0),c.value.selected?(m(),h("div",me,[ge,t("div",ve,d(a(N)(g.value*((C=l.value.product)==null?void 0:C.price))),1)])):K("",!0),c.value.selected?(m(),h("div",fe,[he,I(a(D),{modelValue:n.value,"onUpdate:modelValue":e[7]||(e[7]=p=>n.value=p),label:"Nilai Ketertarikan",name:"voi",rules:"required"},{default:B(({errorMessage:p})=>[t("input",{ref_key:"refVoi",ref:b,type:"text",class:"form-control text-right custom-form-control font-bold",onKeyup:e[6]||(e[6]=(...r)=>a(F)&&a(F)(...r))},null,544),p?(m(),h("div",be,d(p),1)):K("",!0)]),_:1},8,["modelValue"]),n.value?(m(),h("div",ke," Selisih Nilai Anggaran "+d(a(N)((L=l.value)==null?void 0:L.selisih)),1)):K("",!0)])):K("",!0),t("button",{type:"button",class:q({"btn btn-primary btn-block":!0,disabled:x}),onClick:P}," Simpan ",2)]}),_:1},512),ye]),_:1},8,["visible"])])}}},it="/kbm/build/assets/full-size-01-f97970ff.jpg";const xe={class:"sp-single sp-single-1 des_pr_layout_1 mb__60"},we={class:"bgbl pt__20 pb__20 lh__1"},Se={class:"container"},Ae={class:"row al_center"},Ve={class:"col"},Ce={class:"sp-breadcrumb"},Be=t("i",{class:"facl facl-angle-right"},null,-1),Ie=t("i",{class:"facl facl-angle-right"},null,-1),Te={class:"container container_cat cat_default"},qe={class:"row product mt__40"},Le={class:"col-md-12 col-12 thumb_left"},Fe={class:"row mb__50 pr_sticky_content"},Pe={class:"col-md-6 col-12 pr product-images img_action_zoom pr_sticky_img kalles_product_thumnb_slide"},Ke={class:"row"},Ne={class:"col-12 col-lg col_thumb"},je=["data-mdid","data-src","data-bgset","data-cap"],He={class:"col-md-6 col-12 product-infors pr_sticky_su"},Re={class:"kalles-section-pr_summary kalles-section summary entry-summary mt__30"},ze={class:"product_title entry-title fs__16"},Oe={class:"flex wrap fl_between al_center price-review"},Ue={id:"price_ppr",class:"price_range"},Ye={class:"pr_short_des"},De={class:"mg__0"},Me={class:"btn-atc atc-slide btn_des_1 btn_txt_3"},Ee={id:"callBackVariant_ppr"},Xe={class:"nt_cart_form variations_form variations_form_ppr"},Ge={class:"variations_button in_flex column w__100 buy_qv_false"},Je={key:0,class:"flex wrap"},Qe={class:"txt_add"},We={key:1,class:"flex wrap"},Ze=t("button",{type:"button",class:"single_add_to_cart_button button truncate round_true w__100 mt__20 order-4 d-inline-block disabled bg-secondary"},[t("span",{class:"txt_add"}," Event sudah berakhir ")],-1),ts=[Ze],ds={__name:"Index",props:{tenantSlug:{type:String,required:!0},productSlug:{type:String,required:!0}},setup(A){const i=A,w=ot(i,"tenantSlug"),u=ot(i,"productSlug"),l=kt(),g=k({product:{ref:null,el:null}}),b={product:{initialIndex:".media_id_001",fade:!0,draggable:">1",cellAlign:"center",wrapAround:!0,autoPlay:!1,prevNextButtons:!0,adaptiveHeight:!0,imagesLoaded:!1,lazyLoad:0,dragThreshold:6,pageDots:!1,rightToLeft:!1}},{product:v,backToTenant:n}=xt(w.value,u.value);return W(()=>{l.initializeCustomRef(g.value.product.ref,g.value.product.el,b.product)}),(y,f)=>{const c=X("FontAwesomeIcon");return m(),nt(yt,null,{default:B(()=>{var V,T,F,P,o,e,s,_,S,$,x,C,L,p;return[t("div",xe,[t("div",we,[t("div",Se,[t("div",Ae,[t("div",Ve,[t("nav",Ce,[t("a",{class:"pointer text-info",onClick:f[0]||(f[0]=r=>y.$router.push({name:"landing.home"}))},"Home"),Be,t("a",{class:"pointer text-info",onClick:f[1]||(f[1]=(...r)=>a(n)&&a(n)(...r))},d((T=(V=a(v))==null?void 0:V.data)==null?void 0:T.tenant_name),1),Ie,H(" "+d((P=(F=a(v))==null?void 0:F.data)==null?void 0:P.product_name),1)])])])])]),t("div",Te,[t("div",qe,[t("div",Le,[t("div",Fe,[t("div",Pe,[t("div",Ke,[t("div",Ne,[t("div",{ref:r=>g.value.product.ref=r,class:"p-thumb p-thumb_ppr images sp-pr-gallery equal_nt nt_contain ratio_imgtrue position_8 nt_slider pr_carousel"},[(m(!0),h(G,null,ft((e=(o=a(v))==null?void 0:o.data)==null?void 0:e.images,(r,j)=>{var z,O;return m(),h("div",{key:j,class:q(`img_ptw p_ptw p-item sp-pr-gallery__img w__100 nt_bg_lz lazyload padding-top__127_66 media_id_${(j+1).toString().padStart(3,"0")}`),"data-mdid":(j+1).toString().padStart(3,"0"),"data-height":"1440","data-width":"1128","data-ratio":"0.7833333333333333","data-mdtype":"image","data-src":r||a(it),"data-bgset":r||a(it),"data-cap":(O=(z=a(v))==null?void 0:z.data)==null?void 0:O.product_name},null,10,je)}),128))],512)])])]),t("div",He,[t("div",Re,[t("h1",ze,d((_=(s=a(v))==null?void 0:s.data)==null?void 0:_.product_name),1),t("div",Oe,[t("p",Ue,d(a(N)(($=(S=a(v))==null?void 0:S.data)==null?void 0:$.price)),1)]),t("div",Ye,[t("p",De,d((C=(x=a(v))==null?void 0:x.data)==null?void 0:C.description),1)]),t("div",Me,[t("div",Ee,[t("div",Xe,[t("div",Ge,[((p=(L=a(R))==null?void 0:L.events[0])==null?void 0:p.flag)=="active"?(m(),h("div",Je,[a(R).user?(m(),nt($e,{key:1,class:"single_add_to_cart_button button truncate round_true w__100 mt__20 order-4 d-inline-block","tenant-slug":w.value,"product-slug":u.value,product:a(v).data},null,8,["tenant-slug","product-slug","product"])):(m(),h("button",{key:0,type:"button","data-time":"6000","data-ani":"shake",class:"single_add_to_cart_button button truncate round_true w__100 mt__20 order-4 d-inline-block",onClick:f[2]||(f[2]=(...r)=>a(J)&&a(J)(...r))},[t("span",Qe,[I(c,{icon:["fas","plus"]}),H(" Ketertarikan ")])]))])):(m(),h("div",We,ts))])])])])])])])])])])])]}),_:1})}}};export{ds as default};
