import{fl as q,fq as S,r as O,o,c as i,fp as e,fo as n,fr as z,fs as G,fv as f,a as K,fu as w,fD as Q,fm as X,ho as L,hp as P,fQ as p,u as _,hr as y,fO as x,fT as Y,hs as Z,hD as ee,hq as R}from"./vee-validate-i18n.esm-14720df6.js";import{_ as te}from"./CropperImage-fffb8212.js";const ae={class:"uploader-image-wrapper"},se={for:"file-input",class:"border"},oe=["accept"],le=["src"],ne=["onClick"],ie={key:0,class:"fs-nano text-danger"},re={__name:"UploadingImage",props:{accept:{type:Array,required:!1,default:()=>["image/gif","image/jpg","image/jpeg","image/png","image/tiff"]},maxSize:{type:Number,required:!1,default:5},modelValue:{type:[Array,null],required:!0,default:null},urlObject:{type:[Array,null],required:!1,default:null},errorMessage:{type:[String,null],required:!1,default:null}},emits:["update:modelValue","update:urlObject","cropping"],setup(j,{emit:V}){const F=j,I=window.URL||window.webkitURL,v=q([]),s=S(()=>F.accept.join(",")),H=l=>{if(!l.target.files.length)return;Array.from(l.target.files).forEach(r=>{const h={visible:!0,input:I.createObjectURL(r),output:null,name:r.name,mime:r.type,file:null};v.value.push(h)}),Q(()=>l.target.value="")},b=({image:l})=>{const m=v.value[v.value.length-1];m.output=I.createObjectURL(l),m.file=new File([l],m.name,{type:m.mime}),U()},C=l=>{v.value.splice(l,1),U()},U=()=>{const l=v.value.map(r=>r.file),m=v.value.map(r=>r.output);V("update:modelValue",l),V("update:urlObject",m),V("cropping",{files:l,urlObjects:m})};return(l,m)=>{const r=O("FontAwesomeIcon");return o(),i("div",ae,[e("label",se,[n(r,{icon:["far","image"]}),e("input",{id:"file-input",type:"file",name:"upload",multiple:"",accept:s.value,onChange:H},null,40,oe)]),(o(!0),i(z,null,G(v.value,(h,N)=>(o(),i("div",{key:N,class:"preview-wrapper"},[h.output?(o(),i("img",{key:0,src:h.output,class:"image-preview",alt:"Output after crop and resize"},null,8,le)):f("",!0),e("a",{href:"javascript:void(0)",onClick:T=>C(N)},[n(r,{icon:["fas","trash-alt"]})],8,ne),h.visible?(o(),K(te,{key:1,visible:h.visible,"onUpdate:visible":T=>h.visible=T,"image-url":h.input,onAfterCropping:b},null,8,["visible","onUpdate:visible","image-url"])):f("",!0)]))),128)),j.errorMessage?(o(),i("div",ie,w(j.errorMessage),1)):f("",!0)])}}};const ce={class:"px-3 pb-0 mb-0"},ue={class:"form-group row"},de=e("label",{for:"tenant",class:"col-sm-3 col-form-label"}," Tenant ",-1),me={class:"col-sm-9"},pe={key:0,class:"form-text text-danger fs-nano"},_e={class:"form-group row"},fe=e("label",{for:"name",class:"col-sm-3 col-form-label"}," Nama Barang ",-1),ve={class:"col-sm-9"},he={key:0,class:"form-text text-danger fs-nano"},be={class:"form-group row"},ge=e("label",{for:"deskripsi",class:"col-sm-3 col-form-label"}," Deskripsi ",-1),ke={class:"col-sm-9"},ye={key:0,class:"form-text text-danger fs-nano"},xe={class:"form-group row"},we=e("label",{for:"min_qty",class:"col-sm-3 col-form-label"}," Minimum Kuantiti ",-1),qe={class:"col-sm-9"},Ve={key:0,class:"form-text text-danger fs-nano"},Fe={class:"form-group row"},Ae=e("label",{for:"min_unit",class:"col-sm-3 col-form-label"}," Minimum Unit ",-1),je={class:"col-sm-9"},Ce={key:0,class:"form-text text-danger fs-nano"},Ue={class:"form-group row"},Te=e("label",{for:"tkdn",class:"col-sm-3 col-form-label"}," Nilai TKDN ",-1),$e={class:"col-sm-9"},Ie={key:0,class:"form-text text-danger fs-nano"},Ne={class:"form-group row"},Be=e("label",{for:"price",class:"col-sm-3 col-form-label"}," Harga ",-1),De={class:"col-sm-9"},Oe={key:0,class:"form-text text-danger fs-nano"},He={class:"form-group row"},Me=e("label",{for:"condition",class:"col-sm-3 col-form-label"}," Kondisi ",-1),Ee={class:"col-sm-9"},Re={key:0,class:"form-text text-danger fs-nano"},Se={class:"form-group row"},Ke=e("label",{class:"col-sm-3 col-form-label"}," Gambar ",-1),Le={class:"col-sm-9"},Pe={key:0,class:"preview-wrapper"},ze=["src","alt"],Ge=["onClick"],Qe={class:"form-group row"},Je={class:"col-sm-9 offset-sm-3"},We={type:"submit",class:"btn btn-primary mr-2"},Xe=["onClick"],et={__name:"ModalForm",props:{visible:{type:Boolean,required:!0,default:!1},initData:{type:[Object,null],required:!1,default:()=>{}},isEdit:{type:Boolean,required:!0,default:!1}},emits:["update:visible","submit"],setup(j,{emit:V}){const F=j;X(()=>{h()});const I=Math.random().toString(36).substring(2,9),v=S(()=>F.visible),s=S(()=>F.initData),H=q(null),b=q(null),C=q(!1),U=q([]),l=q(null),m=q([{text:"Baru",value:"0"},{text:"Bekas",value:"1"}]),r=q(null),h=async()=>{try{const d=(await(await L.get(P("backend.tenant.get",{})).then(k=>k)).data.data).map(k=>({text:k.name,value:k.id}));U.value=d}catch(u){console.error("Error fetching data from the API:",u)}},N=()=>Q(()=>{s.value&&(console.log(s.value),r.value={value:s.value.condition,text:s.value.condition==0?"Baru":"Bekas"},l.value={value:s.value.tenant_id,text:s.value.tenant_name},b.value.setFieldValue("name",s.value.product_name),b.value.setFieldValue("description",s.value.description),b.value.setFieldValue("min_qty",s.value.minimum_qty),b.value.setFieldValue("min_unit",s.value.minimum_unit),b.value.setFieldValue("price",s.value.price),b.value.setFieldValue("tkdn",s.value.tkdn_value),C.value=!0)}),T=()=>V("update:visible",!1),J=u=>{u>=0&&u<s.value.images.length&&(s.value.images.splice(u,1),s.value.images.length===0&&(C.value=!1))},W=(u,{resetForm:g})=>{const d=F.isEdit,k=d?`Apakah Anda yakan untuk mengubah data ${u.name} ?`:`Apakah Anda yakin untuk menambahkan barang ${u.name} ?`,M=d?"put":"post",$=`backend.product.${d?"edit":"store"}`;let a=!1;d&&Object.keys(u).forEach(t=>{u[t]!=s.value[t]&&(a=!0)}),!(d&&!a)&&ee({title:`${d?"Ubah":"Tambah"} barang`,text:k,icon:"question"},()=>{var t;return L.post(P($),{...u,_method:M,slug:d?(t=s.value)==null?void 0:t.slug:null},{headers:{"Content-Type":"multipart/form-data"}}).then(c=>c).catch(c=>{let B=c.response.status,A=c.response.data.message;if([409,417,500].includes(B)){R.showValidationMessage(`${A}`);return}if(B=="422"){const D=c.response.data.errors;A=Object.keys(D).map(E=>Array.isArray(D[E])?D[E].join(", "):D[E]).join(", "),R.showValidationMessage(`${A}`);return}})}).then(({value:t,isConfirmed:c,isDismissed:B})=>{var A;if(B)return!1;c&&t.data.status=="success"&&(R.fire({title:"Tambah barang",text:t.data.message,icon:"success"}),g(),V("submit",(A=t.data)==null?void 0:A.data),T())})};return(u,g)=>{const d=O("vue-multiselect"),k=O("FontAwesomeIcon"),M=O("b-modal");return o(),K(M,{id:_(I),visible:v.value,"onUpdate:visible":g[2]||(g[2]=$=>v.value=$),title:`${F.isEdit?"Ubah":"Tambah"} Barang`,"hide-footer":"",onShown:N,onHide:T},{default:p(({hide:$})=>[e("div",ce,[n(_(Z),{ref_key:"formRef",ref:b,onSubmit:W},{default:p(()=>[e("div",ue,[de,e("div",me,[n(_(y),{label:"Nama tenant",name:"tenant",rules:"required"},{default:p(({field:a,errorMessage:t})=>[n(d,x({modelValue:l.value,"onUpdate:modelValue":g[0]||(g[0]=c=>l.value=c),options:U.value,"close-on-select":!0,"clear-on-select":!1,placeholder:"Pilih nama tenant"},a,{label:"text","track-by":"text"}),null,16,["modelValue","options"]),t?(o(),i("div",pe,w(t),1)):f("",!0)]),_:1})])]),e("div",_e,[fe,e("div",ve,[n(_(y),{label:"Nama barang",name:"name",rules:"required|min:3|max:200"},{default:p(({field:a,errorMessage:t})=>[e("input",x({id:"name",ref_key:"nameInput",ref:H},a,{type:"text",class:"form-control",placeholder:"Masukkan nama barang"}),null,16),t?(o(),i("div",he,w(t),1)):f("",!0)]),_:1})])]),e("div",be,[ge,e("div",ke,[n(_(y),{label:"Deskripsi",name:"description",rules:"required|max:2000"},{default:p(({field:a,errorMessage:t})=>[e("textarea",x({id:"deskripsi"},a,{type:"text",class:"form-control custom-scroll",placeholder:"Masukkan deskripsi tentang barang"}),null,16),t?(o(),i("div",ye,w(t),1)):f("",!0)]),_:1})])]),e("div",xe,[we,e("div",qe,[n(_(y),{label:"Minimum kuantiti",name:"min_qty",rules:"required|min:1|max:11"},{default:p(({field:a,errorMessage:t})=>[e("input",x({id:"min_qty"},a,{type:"number",class:"form-control",placeholder:"Masukkan jumlah minimum kuantity"}),null,16),t?(o(),i("div",Ve,w(t),1)):f("",!0)]),_:1})])]),e("div",Fe,[Ae,e("div",je,[n(_(y),{label:"Nama barang",name:"min_unit",rules:"required|min:1|max:11"},{default:p(({field:a,errorMessage:t})=>[e("input",x({id:"min_unit"},a,{class:"form-control",placeholder:"Masukkan minimum unit"}),null,16),t?(o(),i("div",Ce,w(t),1)):f("",!0)]),_:1})])]),e("div",Ue,[Te,e("div",$e,[n(_(y),{label:"Nilai TKDN",name:"tkdn",rules:"required|numeric"},{default:p(({field:a,errorMessage:t})=>[e("input",x({id:"tkdn"},a,{class:"form-control",placeholder:"Masukkan nilai TKDN"}),null,16),t?(o(),i("div",Ie,w(t),1)):f("",!0)]),_:1})])]),e("div",Ne,[Be,e("div",De,[n(_(y),{label:"Harga",name:"price",rules:"required|min:1|max:200"},{default:p(({field:a,errorMessage:t})=>[e("input",x({id:"price"},a,{type:"number",class:"form-control",placeholder:"Masukkan harga"}),null,16),t?(o(),i("div",Oe,w(t),1)):f("",!0)]),_:1})])]),e("div",He,[Me,e("div",Ee,[n(_(y),{label:"Kondisi",name:"condition",rules:"required"},{default:p(({field:a,errorMessage:t})=>[n(d,x({modelValue:r.value,"onUpdate:modelValue":g[1]||(g[1]=c=>r.value=c),options:m.value,"close-on-select":!0,"clear-on-select":!1,placeholder:"Pilih kondisi"},a,{label:"text","track-by":"text"}),null,16,["modelValue","options"]),t?(o(),i("div",Re,w(t),1)):f("",!0)]),_:1})])]),e("div",Se,[Ke,e("div",Le,[C.value?(o(),i("div",Pe,[(o(!0),i(z,null,G(s.value.images,(a,t)=>{var c;return o(),i("div",{key:t},[e("img",{src:(c=s.value)==null?void 0:c.images[t],alt:a.product_name,class:"image-preview"},null,8,ze),e("a",{href:"javascript:void(0)",onClick:()=>J(t)},[n(k,{icon:["fas","trash-alt"]})],8,Ge)])}),128))])):(o(),K(_(y),{key:1,label:"Gambar",name:"pict",rules:"required"},{default:p(({field:a,errorMessage:t})=>[n(re,x(a,{"error-message":t}),null,16,["error-message"])]),_:1}))])]),e("div",Qe,[e("div",Je,[e("button",We,[n(k,{icon:["fas","save"],class:"mr-1"}),Y(" Simpan ")]),e("button",{type:"reset",class:"btn btn-light",onClick:$}," Batal ",8,Xe)])])]),_:2},1536)])]),_:1},8,["id","visible","title"])}}};export{et as _};
