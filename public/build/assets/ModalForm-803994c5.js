import{fl as q,fq as R,r as O,o as l,c as i,fp as e,fo as n,fr as z,fs as G,fv as f,a as K,fu as w,fI as W,fm as Z,gW as L,gX as P,gS as p,u as _,gZ as y,g_ as x,gT as J,g$ as Q,hg as ee,gY as E}from"./vee-validate-i18n.esm-2681c40c.js";import{_ as te}from"./CropperImage-b1fc698f.js";const ae={class:"uploader-image-wrapper"},se={for:"file-input",class:"border"},le=["accept"],oe=["src"],ne=["onClick"],ie={key:0,class:"fs-nano text-danger"},re={__name:"UploadingImage",props:{accept:{type:Array,required:!1,default:()=>["image/gif","image/jpg","image/jpeg","image/png","image/tiff"]},maxSize:{type:Number,required:!1,default:5},modelValue:{type:[Array,null],required:!0,default:null},urlObject:{type:[Array,null],required:!1,default:null},errorMessage:{type:[String,null],required:!1,default:null}},emits:["update:modelValue","update:urlObject","cropping"],setup(j,{emit:V}){const F=j,T=window.URL||window.webkitURL,v=q([]),s=R(()=>F.accept.join(",")),H=o=>{if(!o.target.files.length)return;Array.from(o.target.files).forEach(r=>{const h={visible:!0,input:T.createObjectURL(r),output:null,name:r.name,mime:r.type,file:null};v.value.push(h)}),W(()=>o.target.value="")},g=({image:o})=>{const m=v.value[v.value.length-1];m.output=T.createObjectURL(o),m.file=new File([o],m.name,{type:m.mime}),U()},C=o=>{v.value.splice(o,1),U()},U=()=>{const o=v.value.map(r=>r.file),m=v.value.map(r=>r.output);V("update:modelValue",o),V("update:urlObject",m),V("cropping",{files:o,urlObjects:m})};return(o,m)=>{const r=O("FontAwesomeIcon");return l(),i("div",ae,[e("label",se,[n(r,{icon:["far","image"]}),e("input",{id:"file-input",type:"file",name:"upload",multiple:"",accept:s.value,onChange:H},null,40,le)]),(l(!0),i(z,null,G(v.value,(h,N)=>(l(),i("div",{key:N,class:"preview-wrapper"},[h.output?(l(),i("img",{key:0,src:h.output,class:"image-preview",alt:"Output after crop and resize"},null,8,oe)):f("",!0),e("a",{href:"javascript:void(0)",onClick:$=>C(N)},[n(r,{icon:["fas","trash-alt"]})],8,ne),h.visible?(l(),K(te,{key:1,visible:h.visible,"onUpdate:visible":$=>h.visible=$,"image-url":h.input,onAfterCropping:g},null,8,["visible","onUpdate:visible","image-url"])):f("",!0)]))),128)),j.errorMessage?(l(),i("div",ie,w(j.errorMessage),1)):f("",!0)])}}};const ce={class:"px-3 pb-0 mb-0"},ue={class:"form-group row"},de=e("label",{for:"tenant",class:"col-sm-3 col-form-label"}," Tenant ",-1),me={class:"col-sm-9"},pe={key:0,class:"form-text text-danger fs-nano"},_e={class:"form-group row"},fe=e("label",{for:"name",class:"col-sm-3 col-form-label"}," Nama Barang ",-1),ve={class:"col-sm-9"},he={key:0,class:"form-text text-danger fs-nano"},ge={class:"form-group row"},be=e("label",{for:"deskripsi",class:"col-sm-3 col-form-label"}," Deskripsi ",-1),ke={class:"col-sm-9"},ye={key:0,class:"form-text text-danger fs-nano"},xe={class:"form-group row"},we=e("label",{for:"min_qty",class:"col-sm-3 col-form-label"}," Minimum Kuantiti ",-1),qe={class:"col-sm-9"},Ve={key:0,class:"form-text text-danger fs-nano"},Fe={class:"form-group row"},Ae=e("label",{for:"min_unit",class:"col-sm-3 col-form-label"}," Minimum Unit ",-1),je={class:"col-sm-9"},Ce={key:0,class:"form-text text-danger fs-nano"},Ue={class:"form-group row"},$e=e("label",{for:"tkdn",class:"col-sm-3 col-form-label"}," Nilai TKDN ",-1),Ie={class:"col-sm-9"},Te={key:0,class:"form-text text-danger fs-nano"},Ne={class:"form-group row"},Be=e("label",{for:"price",class:"col-sm-3 col-form-label"}," Harga ",-1),De={class:"col-sm-9"},Oe={key:0,class:"form-text text-danger fs-nano"},He={class:"form-group row"},Me=e("label",{for:"condition",class:"col-sm-3 col-form-label"}," Kondisi ",-1),Se={class:"col-sm-9"},Ee={key:0,class:"form-text text-danger fs-nano"},Re={class:"form-group row"},Ke=e("label",{class:"col-sm-3 col-form-label"}," Gambar ",-1),Le={class:"col-sm-9"},Pe={key:0,class:"preview-wrapper"},ze=["src","alt"],Ge=["onClick"],We={class:"form-group row"},Xe={class:"col-sm-9 offset-sm-3"},Ye={type:"submit",class:"btn btn-primary mr-2"},Ze=["onClick"],et={__name:"ModalForm",props:{visible:{type:Boolean,required:!0,default:!1},initData:{type:[Object,null],required:!1,default:()=>{}},isEdit:{type:Boolean,required:!0,default:!1}},emits:["update:visible","submit"],setup(j,{emit:V}){const F=j;Z(()=>{h()});const T=Math.random().toString(36).substring(2,9),v=R(()=>F.visible),s=R(()=>F.initData),H=q(null),g=q(null),C=q(!1),U=q([]),o=q(null),m=q([{text:"Baru",value:"0"},{text:"Bekas",value:"1"}]),r=q(null),h=async()=>{try{const c=(await(await L.get(P("backend.tenant.get",{})).then(k=>k)).data.data).map(k=>({text:k.name,value:k.id}));U.value=c,c.length>0&&(o.value=c[0].value)}catch(d){console.error("Error fetching data from the API:",d)}},N=()=>W(()=>{s.value&&(console.log(s.value),r.value={value:s.value.condition,text:s.value.condition==0?"Baru":"Bekas"},o.value={value:s.value.tenant_id,text:s.value.tenant_name},g.value.setFieldValue("name",s.value.product_name),g.value.setFieldValue("description",s.value.description),g.value.setFieldValue("min_qty",s.value.minimum_qty),g.value.setFieldValue("min_unit",s.value.minimum_unit),g.value.setFieldValue("price",s.value.price),g.value.setFieldValue("tkdn",s.value.tkdn_value),C.value=!0)}),$=()=>V("update:visible",!1),X=d=>{d>=0&&d<s.value.images.length&&(s.value.images.splice(d,1),s.value.images.length===0&&(C.value=!1))},Y=(d,{resetForm:b})=>{const c=F.isEdit,k=c?`Apakah Anda yakan untuk mengubah data ${d.name} ?`:`Apakah Anda yakin untuk menambahkan barang ${d.name} ?`,M=c?"put":"post",I=`backend.product.${c?"edit":"store"}`;let a=!1;c&&Object.keys(d).forEach(t=>{d[t]!=s.value[t]&&(a=!0)}),!(c&&!a)&&ee({title:`${c?"Ubah":"Tambah"} barang`,text:k,icon:"question"},()=>{var t;return L.post(P(I),{...d,_method:M,slug:c?(t=s.value)==null?void 0:t.slug:null},{headers:{"Content-Type":"multipart/form-data"}}).then(u=>u).catch(u=>{let B=u.response.status,A=u.response.data.message;if([409,417,500].includes(B)){E.showValidationMessage(`${A}`);return}if(B=="422"){const D=u.response.data.errors;A=Object.keys(D).map(S=>Array.isArray(D[S])?D[S].join(", "):D[S]).join(", "),E.showValidationMessage(`${A}`);return}})}).then(({value:t,isConfirmed:u,isDismissed:B})=>{var A;if(B)return!1;u&&t.data.status=="success"&&(E.fire({title:"Tambah barang",text:t.data.message,icon:"success"}),b(),V("submit",(A=t.data)==null?void 0:A.data),$())})};return(d,b)=>{const c=O("vue-multiselect"),k=O("FontAwesomeIcon"),M=O("b-modal");return l(),K(M,{id:_(T),visible:v.value,"onUpdate:visible":b[2]||(b[2]=I=>v.value=I),title:`${F.isEdit?"Ubah":"Tambah"} Barang`,"hide-footer":"",onShown:N,onHide:$},{default:p(({hide:I})=>[e("div",ce,[n(_(Q),{ref_key:"formRef",ref:g,onSubmit:Y},{default:p(()=>[e("div",ue,[de,e("div",me,[n(_(y),{label:"Nama tenant",name:"tenant",rules:"required"},{default:p(({field:a,errorMessage:t})=>[n(c,x({modelValue:o.value,"onUpdate:modelValue":b[0]||(b[0]=u=>o.value=u),options:U.value,"close-on-select":!0,"clear-on-select":!1,placeholder:"Pilih nama tenant"},a,{label:"text","track-by":"text"}),null,16,["modelValue","options"]),t?(l(),i("div",pe,w(t),1)):f("",!0)]),_:1})])]),e("div",_e,[fe,e("div",ve,[n(_(y),{label:"Nama barang",name:"name",rules:"required|min:3|max:200"},{default:p(({field:a,errorMessage:t})=>[e("input",x({id:"name",ref_key:"nameInput",ref:H},a,{type:"text",class:"form-control",placeholder:"Masukkan nama barang"}),null,16),t?(l(),i("div",he,w(t),1)):f("",!0)]),_:1})])]),e("div",ge,[be,e("div",ke,[n(_(y),{label:"Deskripsi",name:"description",rules:"required|max:2000"},{default:p(({field:a,errorMessage:t})=>[e("textarea",x({id:"deskripsi"},a,{type:"text",class:"form-control custom-scroll",placeholder:"Masukkan deskripsi tentang barang"}),null,16),t?(l(),i("div",ye,w(t),1)):f("",!0)]),_:1})])]),e("div",xe,[we,e("div",qe,[n(_(y),{label:"Minimum kuantiti",name:"min_qty",rules:"required|min:1|max:11"},{default:p(({field:a,errorMessage:t})=>[e("input",x({id:"min_qty"},a,{type:"number",class:"form-control",placeholder:"Masukkan jumlah minimum kuantity"}),null,16),t?(l(),i("div",Ve,w(t),1)):f("",!0)]),_:1})])]),e("div",Fe,[Ae,e("div",je,[n(_(y),{label:"Nama barang",name:"min_unit",rules:"required|min:1|max:11"},{default:p(({field:a,errorMessage:t})=>[e("input",x({id:"min_unit"},a,{class:"form-control",placeholder:"Masukkan minimum unit"}),null,16),t?(l(),i("div",Ce,w(t),1)):f("",!0)]),_:1})])]),e("div",Ue,[$e,e("div",Ie,[n(_(y),{label:"Nilai TKDN",name:"tkdn",rules:"required|numeric"},{default:p(({field:a,errorMessage:t})=>[e("input",x({id:"tkdn"},a,{class:"form-control",placeholder:"Masukkan nilai TKDN"}),null,16),t?(l(),i("div",Te,w(t),1)):f("",!0)]),_:1})])]),e("div",Ne,[Be,e("div",De,[n(_(y),{label:"Harga",name:"price",rules:"required|min:1|max:200"},{default:p(({field:a,errorMessage:t})=>[e("input",x({id:"price"},a,{type:"number",class:"form-control",placeholder:"Masukkan harga"}),null,16),t?(l(),i("div",Oe,w(t),1)):f("",!0)]),_:1})])]),e("div",He,[Me,e("div",Se,[n(_(y),{label:"Kondisi",name:"condition",rules:"required"},{default:p(({field:a,errorMessage:t})=>[n(c,x({modelValue:r.value,"onUpdate:modelValue":b[1]||(b[1]=u=>r.value=u),options:m.value,"close-on-select":!0,"clear-on-select":!1,placeholder:"Pilih kondisi"},a,{label:"text","track-by":"text"}),null,16,["modelValue","options"]),t?(l(),i("div",Ee,w(t),1)):f("",!0)]),_:1})])]),e("div",Re,[Ke,e("div",Le,[C.value?(l(),i("div",Pe,[(l(!0),i(z,null,G(s.value.images,(a,t)=>{var u;return l(),i("div",{key:t},[e("img",{src:(u=s.value)==null?void 0:u.images[t],alt:a.product_name,class:"image-preview"},null,8,ze),e("a",{href:"javascript:void(0)",onClick:()=>X(t)},[n(k,{icon:["fas","trash-alt"]})],8,Ge)])}),128))])):(l(),K(_(y),{key:1,label:"Gambar",name:"pict",rules:"required"},{default:p(({field:a,errorMessage:t})=>[n(re,x(a,{"error-message":t}),null,16,["error-message"])]),_:1}))])]),e("div",We,[e("div",Xe,[e("button",Ye,[n(k,{icon:["fas","save"],class:"mr-1"}),J(" Simpan ")]),e("button",{type:"reset",class:"btn btn-light",onClick:I}," Batal ",8,Ze)])])]),_:2},1536)])]),_:1},8,["id","visible","title"])}}};export{et as _};
