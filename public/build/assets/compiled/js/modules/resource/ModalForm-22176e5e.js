import{e as q,c as R,K as E,m as r,L as d,x as i,Q as e,C as S,E as U,u as p,n as N,q as B,G as g,U as I,H as D}from"../../vendor/vue-utils-cea615f1.js";import{F as V,e as P}from"../../vendor/vue-plugins-utils-b3bb03cf.js";import{g as z,e as M,b as G,d as J}from"../../vendor/id-959b107e.js";import{_ as K}from"./CropperImage-47525332.js";const Q=["accept"],W={key:1,class:"preview-wrapper"},X=["src"],Y={key:2,class:"fs-nano text-danger"},Z={__name:"UploadingImageTenant",props:{accept:{type:Array,required:!1,default:()=>["image/gif","image/jpg","image/jpeg","image/png","image/tiff","image/webp"]},maxSize:{type:Number,required:!1,default:5},modelValue:{type:[File,null],required:!0,default:null},urlObject:{type:[String,null],required:!1,default:null},errorMessage:{type:[String,null],required:!1,default:null}},emits:["update:modelValue","update:urlObject","cropping"],setup(L,{emit:f}){const c=L,x=Math.random().toString(36).substring(2,9),h=`uploader-image-${x}`,o=window.URL||window.webkitURL,t=q({visible:!1,input:null,output:null,name:null,mime:null,file:null}),_=R(()=>c.accept.join(",")),b=u=>{if(!u.target.files.length)return;const l=u.target.files[0];t.value.input=o.createObjectURL(l),t.value.visible=!0,t.value.name=l.name,t.value.mime=l.type,N(()=>u.target.value="")},O=({image:u})=>{t.value.output=o.createObjectURL(u),t.value.file=new File([u],t.value.name,{type:t.value.mime}),C()},j=()=>{t.value.input=null,t.value.output=null,t.value.file=null,C()},C=()=>{f("update:modelValue",t.value.file),f("update:urlObject",t.value.output),f("cropping",{file:t.value.file,urlObject:t.value.output})};return(u,l)=>{const m=E("FontAwesomeIcon");return r(),d("div",{key:p(x),class:"uploader-image-wrapper"},[t.value.output?(r(),d("div",W,[e("img",{src:t.value.output,class:"image-preview",alt:"Output after crop and resize"},null,8,X),e("a",{href:"javascript:void(0)",onClick:j},[i(m,{icon:["fas","trash-alt"]})])])):(r(),d("label",{key:0,for:h,class:"border"},[i(m,{icon:["far","image"]}),e("input",{id:h,type:"file",name:"upload",accept:_.value,onChange:b},null,40,Q)])),i(K,{visible:t.value.visible,"onUpdate:visible":l[0]||(l[0]=n=>t.value.visible=n),"image-url":t.value.input,onAfterCropping:O},null,8,["visible","image-url"]),c.errorMessage?(r(),d("div",Y,S(c.errorMessage),1)):U("",!0)])}}};const ee={class:"px-3 pb-0 mb-0"},te={class:"form-group row"},ae=e("label",{for:"nama",class:"col-sm-3 col-form-label"}," Nama ",-1),se={class:"col-sm-9"},oe={key:0,class:"form-text text-danger fs-nano"},le={class:"form-group row"},ne=e("label",{for:"lokasi",class:"col-sm-3 col-form-label"}," Lokasi Singkat ",-1),ie={class:"col-sm-9"},re=e("span",{class:"form-text text-muted fs-nano"},"Contoh: Jakarta Pusat",-1),ue={key:0,class:"form-text text-danger fs-nano"},ce={class:"form-group row"},de=e("label",{for:"deskripsi",class:"col-sm-3 col-form-label"}," Deskripsi ",-1),me={class:"col-sm-9"},pe={key:0,class:"form-text text-danger fs-nano"},fe={class:"form-group row"},_e=e("label",{class:"col-sm-3 col-form-label"}," Logo ",-1),ve={class:"col-sm-9"},ge={key:0,class:"preview-wrapper"},he=["src","alt"],be={class:"form-group row"},ke={class:"col-sm-9 offset-sm-3"},ye={type:"submit",class:"btn btn-primary mr-2"},we=["onClick"],$e={__name:"ModalForm",props:{visible:{type:Boolean,required:!0,default:!1},initData:{type:[Object,null],required:!1,default:()=>{}},isEdit:{type:Boolean,required:!0,default:!1}},emits:["update:visible","submit"],setup(L,{emit:f}){const c=L,x=Math.random().toString(36).substring(2,9),h=R(()=>c.visible),o=R(()=>c.initData),t=q(null),_=q(null),b=q(!1),O=()=>N(()=>{t.value.focus(),o.value&&(_.value.setFieldValue("name",o.value.name),_.value.setFieldValue("short_location",o.value.short_location),_.value.setFieldValue("description",o.value.description),b.value=!0)}),j=()=>f("update:visible",!1),C=()=>b.value=!1,u=(l,{resetForm:m})=>{var w;const n=c.isEdit,T=n?`Apakah Anda yakan untuk mengubah data ${(w=o.value)==null?void 0:w.name} ?`:`Apakah Anda yakin untuk menambahkan ${l.name} sebagai tenant?`,k=n?"put":"post",F=`backend.tenant.${n?"edit":"store"}`;let y=!1;n&&Object.keys(l).forEach(s=>{l[s]!=o.value[s]&&(y=!0)}),!(n&&!y)&&z({title:`${n?"Ubah":"Tambah"} tenant`,text:T,icon:"question"},()=>{var s;return G.post(J(F),{...l,_method:k,slug:n?(s=o.value)==null?void 0:s.slug:null},{headers:{"Content-Type":"multipart/form-data"}}).then(a=>a).catch(a=>{let $=a.response.status,v=a.response.data.message;if([409,417,500].includes($)){M.showValidationMessage(`${v}`);return}if($=="422"){const A=a.response.data.errors;v=Object.keys(A).map(H=>Array.isArray(A[H])?A[H].join(", "):A[H]).join(", "),M.showValidationMessage(`${v}`);return}})}).then(({value:s,isConfirmed:a,isDismissed:$})=>{var v;if($)return!1;a&&s.data.status=="success"&&(M.fire({title:"Tambah tenant",text:s.data.message,icon:"success"}),m(),f("submit",(v=s.data)==null?void 0:v.data),j())})};return(l,m)=>{const n=E("FontAwesomeIcon"),T=E("b-modal");return r(),B(T,{id:p(x),visible:h.value,"onUpdate:visible":m[0]||(m[0]=k=>h.value=k),title:`${c.isEdit?"Ubah":"Tambah"} Tenant`,"hide-footer":"",onShown:O,onHide:j},{default:g(({hide:k})=>[e("div",ee,[i(p(P),{ref_key:"formRef",ref:_,onSubmit:u},{default:g(()=>{var F,y,w;return[e("div",te,[ae,e("div",se,[i(p(V),{label:"Nama tenant",name:"name",rules:"required|min:3|max:200"},{default:g(({field:s,errorMessage:a})=>[e("input",I({id:"nama",ref_key:"nameInput",ref:t},s,{type:"text",class:"form-control",placeholder:"Masukkan nama tenant"}),null,16),a?(r(),d("div",oe,S(a),1)):U("",!0)]),_:1})])]),e("div",le,[ne,e("div",ie,[i(p(V),{label:"Lokasi singkat",name:"short_location",rules:"max:50"},{default:g(({field:s,errorMessage:a})=>[e("input",I({id:"lokasi"},s,{type:"text",class:"form-control",placeholder:"Masukkan lokasi singkat tenant"}),null,16),re,a?(r(),d("div",ue,S(a),1)):U("",!0)]),_:1})])]),e("div",ce,[de,e("div",me,[i(p(V),{label:"Deskripsi",name:"description",rules:"max:2000"},{default:g(({field:s,errorMessage:a})=>[e("textarea",I({id:"deskripsi"},s,{type:"text",class:"form-control custom-scroll",placeholder:"Masukkan deskripsi tentang tenant"}),null,16),a?(r(),d("div",pe,S(a),1)):U("",!0)]),_:1})])]),e("div",fe,[_e,e("div",ve,[b.value?(r(),d("div",ge,[e("img",{src:(y=(F=o.value)==null?void 0:F.logo)==null?void 0:y.thumb,alt:(w=o.value)==null?void 0:w.name,class:"image-preview"},null,8,he),e("a",{href:"javascript:void(0)",onClick:C},[i(n,{icon:["fas","trash-alt"]})])])):(r(),B(p(V),{key:1,label:"Logo",name:"logo",rules:"required"},{default:g(({field:s,errorMessage:a})=>[i(Z,I(s,{"error-message":a}),null,16,["error-message"])]),_:1}))])]),e("div",be,[e("div",ke,[e("button",ye,[i(n,{icon:["fas","save"],class:"mr-1"}),D(" Simpan ")]),e("button",{type:"reset",class:"btn btn-light",onClick:k}," Batal ",8,we)])])]}),_:2},1536)])]),_:1},8,["id","visible","title"])}}};export{$e as _};
