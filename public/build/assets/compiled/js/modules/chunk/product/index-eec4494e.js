import{o as W,c as z,e as k,K as T,m as u,q as Y,G as i,Q as e,x as s,u as _,U as $,L as b,C as v,E as B,H as L,n as X,R as Z,z as ee,a1 as te,F as ae,B as se,y as ne}from"../../../vendor/vue-utils-cea615f1.js";import{b as P,d as E,g as J,e as N,a as oe}from"../../../vendor/id-53336ca1.js";import{u as le}from"../../resource/tenant-store-b79b68a4.js";import{_ as ie}from"../../resource/Spinner-d1bede5f.js";import{F as A,e as re}from"../../../vendor/vue-plugins-utils-b3bb03cf.js";import{_ as ce}from"../../resource/UploadingImage-82fb08a5.js";import"../../../vendor/common-utils-a1d3ee46.js";import"../../../vendor/bootstrap-utils-9ffca17a.js";import"../../../vendor/jquery-utils-4b2e19e3.js";import"../../../vendor/images-utils-205332c6.js";const de={class:"px-3 pb-0 mb-0"},ue={class:"form-group row"},me=e("label",{for:"tenant",class:"col-sm-3 col-form-label"}," Tenan ",-1),pe={class:"col-sm-9"},_e={key:0,class:"form-text text-danger fs-nano"},fe={class:"form-group row"},he=e("label",{for:"name",class:"col-sm-3 col-form-label"}," Nama Barang ",-1),be={class:"col-sm-9"},ve={key:0,class:"form-text text-danger fs-nano"},ge={class:"form-group row"},ye=e("label",{for:"deskripsi",class:"col-sm-3 col-form-label"}," Deskripsi ",-1),ke={class:"col-sm-9"},xe={key:0,class:"form-text text-danger fs-nano"},we={class:"form-group row"},$e=e("label",{for:"min_qty",class:"col-sm-3 col-form-label"}," Minimum Kuantiti ",-1),Ae={class:"col-sm-9"},Te={key:0,class:"form-text text-danger fs-nano"},Be={class:"form-group row"},Se=e("label",{for:"min_unit",class:"col-sm-3 col-form-label"}," Minimum Unit ",-1),qe={class:"col-sm-9"},Ce={key:0,class:"form-text text-danger fs-nano"},Ve={class:"form-group row"},De=e("label",{for:"tkdn",class:"col-sm-3 col-form-label"}," Nilai TKDN ",-1),Ne={class:"col-sm-9"},je={key:0,class:"form-text text-danger fs-nano"},Fe={class:"form-group row"},He=e("label",{for:"price",class:"col-sm-3 col-form-label"}," Harga ",-1),Ie={class:"col-sm-9"},Me={key:0,class:"form-text text-danger fs-nano"},Ue={class:"form-group row"},Pe=e("label",{for:"condition",class:"col-sm-3 col-form-label"}," Kondisi ",-1),Ee={class:"col-sm-9"},Ke={key:0,class:"form-text text-danger fs-nano"},Re={class:"form-group row"},Oe=e("label",{class:"col-sm-3 col-form-label"}," Gambar ",-1),Ge={class:"col-sm-9"},Le={key:0,class:"preview-wrapper"},Qe=["src","alt"],ze={class:"form-group row"},Ye={class:"col-sm-9 offset-sm-3"},Je={type:"submit",class:"btn btn-primary mr-2"},We=["onClick"],Xe={__name:"ModalForm",props:{visible:{type:Boolean,required:!0,default:!1},initData:{type:[Object,null],required:!1,default:()=>{}},isEdit:{type:Boolean,required:!0,default:!1}},emits:["update:visible","submit"],setup(Q,{emit:q}){const C=Q;W(()=>{f()});const K=Math.random().toString(36).substring(2,9),V=z(()=>C.visible),t=z(()=>C.initData),R=k(null),j=k(null),F=k(!1),c=k([]),n=k(null),r=k([{text:"Baru",value:"0"},{text:"Bekas",value:"1"}]),d=k(null),f=async()=>{try{const m=(await(await P.get(E("backend.tenant.get",{})).then(w=>w)).data.data).map(w=>({text:w.name,value:w.id}));c.value=m}catch(h){console.error("Error fetching data from the API:",h)}},g=()=>X(()=>{t.value&&(j.value.setFieldValue("name",t.value.name),j.value.setFieldValue("description",t.value.description),F.value=!0)}),S=()=>q("update:visible",!1),D=()=>F.value=!1,l=(h,{resetForm:x})=>{var M;const m=C.isEdit,w=m?`Apakah Anda yakan untuk mengubah data ${(M=t.value)==null?void 0:M.name} ?`:`Apakah Anda yakin untuk menambahkan barang ${h.name} ?`,O=m?"put":"post",H=`backend.product.${m?"edit":"store"}`;let I=!1;m&&Object.keys(h).forEach(p=>{h[p]!=t.value[p]&&(I=!0)}),!(m&&!I)&&J({title:`${m?"Ubah":"Tambah"} barang`,text:w,icon:"question"},()=>{var p;return P.post(E(H),{...h,_method:O,slug:m?(p=t.value)==null?void 0:p.slug:null},{headers:{"Content-Type":"multipart/form-data"}}).then(o=>o).catch(o=>{let a=o.response.status,y=o.response.data.message;if([409,417,500].includes(a)){N.showValidationMessage(`${y}`);return}if(a=="422"){const U=o.response.data.errors;y=Object.keys(U).map(G=>Array.isArray(U[G])?U[G].join(", "):U[G]).join(", "),N.showValidationMessage(`${y}`);return}})}).then(({value:p,isConfirmed:o,isDismissed:a})=>{var y;if(a)return!1;o&&p.data.status=="success"&&(N.fire({title:"Tambah barang",text:p.data.message,icon:"success"}),x(),q("submit",(y=p.data)==null?void 0:y.data),S())})};return(h,x)=>{const m=T("vue-multiselect"),w=T("FontAwesomeIcon"),O=T("b-modal");return u(),Y(O,{id:_(K),visible:V.value,"onUpdate:visible":x[2]||(x[2]=H=>V.value=H),title:`${C.isEdit?"Ubah":"Tambah"} Barang`,"hide-footer":"",onShown:g,onHide:S},{default:i(({hide:H})=>[e("div",de,[s(_(re),{ref_key:"formRef",ref:j,onSubmit:l},{default:i(()=>{var I,M,p;return[e("div",ue,[me,e("div",pe,[s(_(A),{label:"Nama tenant",name:"tenant",rules:"required"},{default:i(({field:o,errorMessage:a})=>[s(m,$({modelValue:n.value,"onUpdate:modelValue":x[0]||(x[0]=y=>n.value=y),options:c.value,"close-on-select":!0,"clear-on-select":!1,placeholder:"Pilih nama tenan"},o,{label:"text","track-by":"text"}),null,16,["modelValue","options"]),a?(u(),b("div",_e,v(a),1)):B("",!0)]),_:1})])]),e("div",fe,[he,e("div",be,[s(_(A),{label:"Nama barang",name:"name",rules:"required|min:3|max:200"},{default:i(({field:o,errorMessage:a})=>[e("input",$({id:"name",ref_key:"nameInput",ref:R},o,{type:"text",class:"form-control",placeholder:"Masukkan nama barang"}),null,16),a?(u(),b("div",ve,v(a),1)):B("",!0)]),_:1})])]),e("div",ge,[ye,e("div",ke,[s(_(A),{label:"Deskripsi",name:"description",rules:"required|max:2000"},{default:i(({field:o,errorMessage:a})=>[e("textarea",$({id:"deskripsi"},o,{type:"text",class:"form-control custom-scroll",placeholder:"Masukkan deskripsi tentang barang"}),null,16),a?(u(),b("div",xe,v(a),1)):B("",!0)]),_:1})])]),e("div",we,[$e,e("div",Ae,[s(_(A),{label:"Minimum kuantiti",name:"min_qty",rules:"required|min:1|max:11"},{default:i(({field:o,errorMessage:a})=>[e("input",$({id:"min_qty"},o,{type:"number",class:"form-control",placeholder:"Masukkan jumlah minimum kuantity"}),null,16),a?(u(),b("div",Te,v(a),1)):B("",!0)]),_:1})])]),e("div",Be,[Se,e("div",qe,[s(_(A),{label:"Nama barang",name:"min_unit",rules:"required|min:1|max:11"},{default:i(({field:o,errorMessage:a})=>[e("input",$({id:"min_unit"},o,{class:"form-control",placeholder:"Masukkan minimum unit"}),null,16),a?(u(),b("div",Ce,v(a),1)):B("",!0)]),_:1})])]),e("div",Ve,[De,e("div",Ne,[s(_(A),{label:"Nilai TKDN",name:"tkdn",rules:"required|min:3|max:5"},{default:i(({field:o,errorMessage:a})=>[e("input",$({id:"tkdn"},o,{class:"form-control",placeholder:"Masukkan nilai TKDN"}),null,16),a?(u(),b("div",je,v(a),1)):B("",!0)]),_:1})])]),e("div",Fe,[He,e("div",Ie,[s(_(A),{label:"Harga",name:"price",rules:"required|min:1|max:200"},{default:i(({field:o,errorMessage:a})=>[e("input",$({id:"price"},o,{type:"number",class:"form-control",placeholder:"Masukkan harga"}),null,16),a?(u(),b("div",Me,v(a),1)):B("",!0)]),_:1})])]),e("div",Ue,[Pe,e("div",Ee,[s(_(A),{label:"Kondisi",name:"condition",rules:"required"},{default:i(({field:o,errorMessage:a})=>[s(m,$({modelValue:d.value,"onUpdate:modelValue":x[1]||(x[1]=y=>d.value=y),options:r.value,"close-on-select":!0,"clear-on-select":!1,placeholder:"Pilih kondisi"},o,{label:"text","track-by":"text"}),null,16,["modelValue","options"]),a?(u(),b("div",Ke,v(a),1)):B("",!0)]),_:1})])]),e("div",Re,[Oe,e("div",Ge,[F.value?(u(),b("div",Le,[e("img",{src:(M=(I=t.value)==null?void 0:I.pict)==null?void 0:M.thumb,alt:(p=t.value)==null?void 0:p.name,class:"image-preview"},null,8,Qe),e("a",{href:"javascript:void(0)",onClick:D},[s(w,{icon:["fas","trash-alt"]})])])):(u(),Y(_(A),{key:1,label:"Gambar",name:"pict",rules:"required"},{default:i(({field:o,errorMessage:a})=>[s(ce,$(o,{"error-message":a}),null,16,["error-message"])]),_:1}))])]),e("div",ze,[e("div",Ye,[e("button",Je,[s(w,{icon:["fas","save"],class:"mr-1"}),L(" Simpan ")]),e("button",{type:"reset",class:"btn btn-light",onClick:H}," Batal ",8,We)])])]}),_:2},1536)])]),_:1},8,["id","visible","title"])}}},Ze={class:"section-body"},et=e("h2",{class:"section-title fs-lg"},"Daftar Barang",-1),tt=e("p",{class:"section-lead"}," Daftar barang yang akan ditampilkan pada halaman utama ",-1),at={class:"row"},st={class:"col-12"},nt={class:"card border-gray-light"},ot={class:"card-body"},lt={class:"action-wrapper d-flex mb-3 flex-wrap align-items-center justify-content-between"},it={class:"left-section"},rt={class:"right-section mt-2 mt-md-0"},ct={class:"input-group"},dt={class:"input-group-prepend"},ut={class:"input-group-text"},mt={class:"text-center"},pt=e("span",null,"Belum ada data",-1),_t={class:"text-center"},ft=e("span",null,"Data tidak ditemukan",-1),ht={class:"d-flex align-items-baseline justify-content-center"},bt={class:"text-right"},vt={class:"d-flex flex-column"},gt={class:"footer-wrapper"},yt={class:"d-flex justify-content-between align-items-center"},Vt={__name:"Index",setup(Q){const q=k(null),C=Z(),K=le(),V=k(!1),t=k({busy:!1,fields:[{key:"action",label:"Aksi",class:"text-center",sortable:!1,thStyle:{width:"35px"}},{key:"rownum",label:"No",thStyle:{width:"35px",textAlign:"center"}},{key:"tenant_name",label:"Nama Tenan",thStyle:{textAlign:"center",width:"20%"}},{key:"product_name",label:"Nama Barang",thStyle:{textAlign:"center",width:"20%"}},{key:"description",label:"Deskripsi",thStyle:{textAlign:"center"}},{key:"minimum_qty",label:"Minimum QTY",thStyle:{textAlign:"center",width:"88px"}},{key:"minimum_unit",label:"Minimum Unit",thStyle:{textAlign:"center",width:"88px"}},{key:"tkdn_value",label:"Nilai TKDN",thStyle:{textAlign:"center",width:"88px"}},{key:"price",label:"Harga",thStyle:{textAlign:"center",width:"88px"}},{key:"condition",label:"Kondisi",thStyle:{textAlign:"center",width:"88px"}}],search:{filter:null,columns:["name","description"]},meta:{page:1,from:1,limit:15,total:0}}),R=oe.debounce((c,n)=>{t.value.busy=!0,P.get(E("backend.product.get",{search:t.value.search.filter,columns:t.value.search.columns.join(","),page:c.currentPage,limit:c.perPage})).then(r=>{var d,f,g,S,D;t.value.meta.from=(d=r.data)==null?void 0:d.meta.from,t.value.meta.page=(f=r.data)==null?void 0:f.meta.current_page,t.value.meta.limit=(g=r.data)==null?void 0:g.meta.per_page,t.value.meta.total=(S=r.data)==null?void 0:S.meta.total,n((D=r.data)==null?void 0:D.data)}).catch(()=>n([])).finally(()=>setTimeout(()=>t.value.busy=!1,500))},500),j=c=>{J({title:"Hapus Barang",text:`Apakah Anda yakin untuk menghapus data barang an. ${c.product_name}?`,icon:"question"},()=>P.post(E("backend.product.drop"),{_method:"delete",slug:c.slug}).then(n=>n).catch(n=>{let r=n.response.status,d=n.response.data.message;if([409,417,500].includes(r)){N.showValidationMessage(`${d}`);return}if(r=="422"){const f=n.response.data.errors;d=Object.keys(f).map(g=>Array.isArray(f[g])?f[g].join(", "):f[g]).join(", "),N.showValidationMessage(`${d}`);return}})).then(({value:n,isConfirmed:r,isDismissed:d})=>{if(d)return!1;r&&n&&N.fire({title:"Hapus Barang Berhasil",text:`Barang an ${c.product_name} berhasil dihapus`,icon:"success"}),q.value.refresh()})},F=c=>{K.setItemByUrl(c.slug,c),C.push({name:"settings.tenant.detail",params:{slug:c.slug}})};return(c,n)=>{const r=T("FontAwesomeIcon"),d=T("b-button"),f=T("b-table"),g=T("b-dropdown-item"),S=T("b-dropdown"),D=T("b-pagination");return u(),b("div",Ze,[et,tt,e("div",at,[e("div",st,[e("div",nt,[e("div",ot,[e("div",lt,[e("div",it,[e("button",{class:"btn btn-icon icon-left btn-primary",onClick:n[0]||(n[0]=l=>V.value=!0)},[s(r,{icon:["fas","plus"]}),L(" Tambah ")])]),e("div",rt,[e("div",ct,[e("div",dt,[e("div",ut,[s(r,{icon:["fas","search"]})])]),ee(e("input",{"onUpdate:modelValue":n[1]||(n[1]=l=>t.value.search.filter=l),type:"text",class:"form-control",placeholder:"Pencarian"},null,512),[[te,t.value.search.filter]])])])]),s(f,{ref_key:"refTable",ref:q,"table-class":"custom-bordered dataTable",fields:t.value.fields,items:_(R),filter:t.value.search.filter,"current-page":t.value.meta.page,"per-page":t.value.meta.limit,busy:t.value.busy,"show-empty":"",hover:"",striped:"",responsive:""},{"table-busy":i(()=>[s(ie)]),empty:i(()=>[e("div",mt,[s(r,{icon:["fas","exclamation-circle"],class:"mr-2"}),pt])]),emptyfiltered:i(()=>[e("div",_t,[s(r,{icon:["fas","exclamation-circle"],class:"mr-2"}),ft])]),"cell(action)":i(({item:l})=>[e("div",ht,[s(d,{variant:"link",class:"text-info py-0 px-1 outline-none cursor-pointer",onClick:h=>F(l)},{default:i(()=>[s(r,{icon:["fas","info-circle"]})]),_:2},1032,["onClick"]),s(d,{variant:"link",class:"text-danger py-0 px-1 outline-none cursor-pointer",onClick:h=>j(l)},{default:i(()=>[s(r,{icon:["fas","trash-alt"]})]),_:2},1032,["onClick"])])]),"cell(rownum)":i(({index:l})=>[e("div",bt,v(l+1),1)]),"cell(condition)":i(({item:l})=>[e("div",vt,v(l.condition==0?"Baru":"Bekas"),1)]),_:1},8,["fields","items","filter","current-page","per-page","busy"]),e("div",gt,[e("div",yt,[s(S,{variant:"light",class:"mr-2 form-control-height-sm perpage",text:t.value.meta.limit.toString()},{default:i(()=>[(u(),b(ae,null,se([5,10,15,25,50,100],l=>s(g,{key:l,"link-class":"btn",onClick:ne(h=>t.value.meta.limit=l,["prevent"])},{default:i(()=>[L(v(l),1)]),_:2},1032,["onClick"])),64))]),_:1},8,["text"]),s(D,{value:t.value.meta.page,"onUpdate:value":n[2]||(n[2]=l=>t.value.meta.page=l),"total-rows":t.value.meta.total,"per-page":t.value.meta.limit,"aria-controls":"group-table","first-class":"hidden-md-down","last-class":"hidden-md-down",class:"pagination mb-0",onChange:n[3]||(n[3]=l=>t.value.meta.page=l)},null,8,["value","total-rows","per-page"])])])])])])]),s(Xe,{visible:V.value,"onUpdate:visible":n[4]||(n[4]=l=>V.value=l),onSubmit:n[5]||(n[5]=l=>q.value.refresh())},null,8,["visible"])])}}};export{Vt as default};
